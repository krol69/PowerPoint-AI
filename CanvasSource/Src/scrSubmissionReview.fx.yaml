scrSubmissionReview As screen:
    Fill: =gblTheme.Background
    
    OnVisible: |-
        =ClearCollect(colCurrentProjects, Sort(Filter(Projects, SubmissionId.SubmissionId = gblCurrentSubmission.SubmissionId), ProjectIndex, SortOrder.Ascending));
        Set(gblSubmissionMetrics, {
            TotalProjects: CountRows(colCurrentProjects),
            CompleteProjects: CountRows(Filter(colCurrentProjects, CompletionStatus.Value = "Complete")),
            TotalFeatures: Sum(colCurrentProjects, SelectedFeatureCount),
            TotalMissing: Sum(colCurrentProjects, MissingSpecCount)
        });
        Set(gblCanSubmit, gblSubmissionMetrics.TotalProjects > 0 && gblSubmissionMetrics.CompleteProjects = gblSubmissionMetrics.TotalProjects && gblSubmissionMetrics.TotalMissing = 0)
    
    rectAccent As rectangle:
        X: =0
        Y: =0
        Width: =Parent.Width
        Height: =4
        Fill: =If(gblCanSubmit, gblTheme.Success, gblTheme.Warning)
    
    rectHeader As rectangle:
        X: =0
        Y: =4
        Width: =Parent.Width
        Height: =70
        Fill: =gblTheme.BackgroundSecondary
    
    btnBack As button:
        X: =20
        Y: =20
        Width: =130
        Height: =36
        Text: ="← Projects"
        Fill: =Transparent
        Color: =gblTheme.TextSecondary
        Font: =Font.'Segoe UI'
        Size: =12
        BorderRadius: =8
        OnSelect: =Navigate(scrProjectList, ScreenTransition.Fade)
    
    lblTitle As label:
        X: =(Parent.Width - 300) / 2
        Y: =18
        Width: =300
        Height: =40
        Text: ="Submission Review"
        Color: =gblTheme.TextPrimary
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Bold
        Size: =22
        Align: =Align.Center
    
    // Summary Card
    rectSummary As rectangle:
        X: =(Parent.Width - 850) / 2
        Y: =95
        Width: =850
        Height: =120
        Fill: =gblTheme.BackgroundCard
        BorderRadius: =12
    
    lblMetrics As label:
        X: =(Parent.Width - 800) / 2
        Y: =115
        Width: =800
        Height: =80
        Text: ="Projects: " & gblSubmissionMetrics.TotalProjects & " | Complete: " & gblSubmissionMetrics.CompleteProjects & " | Security Features: " & gblSubmissionMetrics.TotalFeatures & " | Missing Specs: " & If(gblSubmissionMetrics.TotalMissing = 0, "None ✓", gblSubmissionMetrics.TotalMissing)
        Color: =gblTheme.TextPrimary
        Font: =Font.'Segoe UI'
        Size: =16
        Align: =Align.Center
    
    // Projects List
    lblProjectsTitle As label:
        X: =(Parent.Width - 850) / 2
        Y: =235
        Width: =200
        Height: =28
        Text: ="Projects"
        Color: =gblTheme.TextPrimary
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Bold
        Size: =16
    
    galProjects As gallery:
        Items: =colCurrentProjects
        X: =(Parent.Width - 850) / 2
        Y: =270
        Width: =850
        Height: =Parent.Height - 400
        TemplateFill: =Transparent
        TemplateSize: =70
        TemplatePadding: =6
        
        rectCard As rectangle:
            X: =0
            Y: =0
            Width: =830
            Height: =62
            Fill: =gblTheme.BackgroundCard
            BorderColor: =If(ThisItem.CompletionStatus.Value = "Complete", gblTheme.Success, gblTheme.Warning)
            BorderThickness: =2
            BorderRadius: =10
        
        lblName As label:
            Text: ="Project " & ThisItem.ProjectIndex & ": " & ThisItem.ProjectName
            X: =20
            Y: =10
            Width: =500
            Height: =22
            Color: =gblTheme.TextPrimary
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Size: =14
        
        lblDetails As label:
            Text: =Coalesce(ThisItem.Customer.Value, "—") & " • " & ThisItem.SelectedFeatureCount & " features"
            X: =20
            Y: =34
            Width: =400
            Height: =20
            Color: =gblTheme.TextSecondary
            Font: =Font.'Segoe UI'
            Size: =12
        
        rectStatus As rectangle:
            X: =700
            Y: =17
            Width: =110
            Height: =26
            Fill: =If(ThisItem.CompletionStatus.Value = "Complete", RGBA(0, 230, 118, 0.2), RGBA(255, 193, 7, 0.2))
            BorderRadius: =13
        
        lblStatus As label:
            Text: =ThisItem.CompletionStatus.Value
            X: =705
            Y: =19
            Width: =100
            Height: =22
            Color: =If(ThisItem.CompletionStatus.Value = "Complete", gblTheme.Success, gblTheme.Warning)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Size: =11
            Align: =Align.Center
    
    // Validation Banner
    rectValidation As rectangle:
        X: =(Parent.Width - 850) / 2
        Y: =Parent.Height - 115
        Width: =850
        Height: =45
        Fill: =If(gblCanSubmit, RGBA(0, 230, 118, 0.15), RGBA(255, 193, 7, 0.15))
        BorderRadius: =10
    
    lblValidation As label:
        X: =(Parent.Width - 830) / 2
        Y: =Parent.Height - 105
        Width: =810
        Height: =25
        Text: =If(gblCanSubmit, "✓ Ready to submit!", If(gblSubmissionMetrics.TotalProjects = 0, "⚠ Add at least one project", "⚠ Complete all projects first"))
        Color: =If(gblCanSubmit, gblTheme.Success, gblTheme.Warning)
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Semibold
        Size: =14
        Align: =Align.Center
    
    // Footer
    rectFooter As rectangle:
        X: =0
        Y: =Parent.Height - 60
        Width: =Parent.Width
        Height: =60
        Fill: =gblTheme.BackgroundSecondary
    
    btnSave As button:
        X: =40
        Y: =Parent.Height - 50
        Width: =130
        Height: =38
        Text: ="Save Draft"
        Fill: =gblTheme.BackgroundCard
        Color: =gblTheme.TextPrimary
        BorderColor: =gblTheme.Border
        BorderThickness: =1
        Font: =Font.'Segoe UI'
        Size: =13
        BorderRadius: =8
        OnSelect: |-
            =Patch(Submissions, gblCurrentSubmission, { LastSavedOn: Now() });
            Notify("Draft saved", NotificationType.Success)
    
    btnSubmit As button:
        X: =Parent.Width - 200
        Y: =Parent.Height - 50
        Width: =160
        Height: =38
        Text: ="Submit →"
        Fill: =If(gblCanSubmit, gblTheme.Success, gblTheme.BackgroundCard)
        Color: =If(gblCanSubmit, gblTheme.TextOnPrimary, gblTheme.TextMuted)
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Bold
        Size: =14
        BorderRadius: =8
        DisplayMode: =If(gblCanSubmit, DisplayMode.Edit, DisplayMode.Disabled)
        OnSelect: =Set(gblShowSubmitConfirm, true)
    
    // Submit Confirmation
    rectOverlay As rectangle:
        X: =0
        Y: =0
        Width: =Parent.Width
        Height: =Parent.Height
        Fill: =RGBA(0, 0, 0, 0.85)
        Visible: =gblShowSubmitConfirm
    
    rectDialog As rectangle:
        X: =(Parent.Width - 450) / 2
        Y: =(Parent.Height - 280) / 2
        Width: =450
        Height: =280
        Fill: =gblTheme.BackgroundCard
        BorderRadius: =16
        Visible: =gblShowSubmitConfirm
    
    lblDialogTitle As label:
        X: =(Parent.Width - 400) / 2
        Y: =(Parent.Height - 280) / 2 + 40
        Width: =400
        Height: =35
        Text: ="Submit Intake?"
        Color: =gblTheme.TextPrimary
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Bold
        Size: =22
        Align: =Align.Center
        Visible: =gblShowSubmitConfirm
    
    lblDialogDesc As label:
        X: =(Parent.Width - 380) / 2
        Y: =(Parent.Height - 280) / 2 + 85
        Width: =380
        Height: =60
        Text: ="Once submitted, this intake will be locked. You and admins will receive email confirmation."
        Color: =gblTheme.TextSecondary
        Font: =Font.'Segoe UI'
        Size: =13
        Align: =Align.Center
        Visible: =gblShowSubmitConfirm
    
    btnCancel As button:
        X: =(Parent.Width - 300) / 2
        Y: =(Parent.Height - 280) / 2 + 180
        Width: =140
        Height: =45
        Text: ="Cancel"
        Fill: =gblTheme.BackgroundSecondary
        Color: =gblTheme.TextPrimary
        Font: =Font.'Segoe UI'
        Size: =14
        BorderRadius: =8
        Visible: =gblShowSubmitConfirm
        OnSelect: =Set(gblShowSubmitConfirm, false)
    
    btnConfirm As button:
        X: =(Parent.Width - 300) / 2 + 160
        Y: =(Parent.Height - 280) / 2 + 180
        Width: =140
        Height: =45
        Text: ="Submit ✓"
        Fill: =gblTheme.Success
        Color: =gblTheme.TextOnPrimary
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Bold
        Size: =14
        BorderRadius: =8
        Visible: =gblShowSubmitConfirm
        OnSelect: |-
            =Patch(Submissions, gblCurrentSubmission, {
                Status: {Value: "Submitted"},
                SubmittedOn: Now(),
                LastSavedOn: Now(),
                TotalProjectCount: gblSubmissionMetrics.TotalProjects,
                CompleteProjectCount: gblSubmissionMetrics.CompleteProjects,
                TotalSecurityFeatures: gblSubmissionMetrics.TotalFeatures
            });
            // <<CHANGE_ADMIN_EMAIL>> - Emails sent here
            // Build comprehensive HTML email for admin
            Set(varProjectSummaries, Concat(colCurrentProjects,
                "<li><strong>" & ProjectName & "</strong><br/>" &
                "Customer: " & Coalesce(Customer.Value, "N/A") &
                If(!IsBlank(CustomerOther), " (" & CustomerOther & ")", "") & "<br/>" &
                "Status: " & Coalesce(ProjectStatus.Value, "N/A") & "<br/>" &
                "Architecture: " & Coalesce(Architecture.Value, "N/A") & "<br/>" &
                "Protocols: " & Coalesce(Protocols, "N/A") & "<br/>" &
                "Security Features: " & SelectedFeatureCount & " selected" &
                If(MissingSpecCount > 0, " ⚠ " & MissingSpecCount & " missing specs", " ✓") &
                "</li>", ""));

            Set(varEmailBodyAdmin,
                "<html><body style='font-family:Segoe UI,Arial,sans-serif;'>" &
                "<h2 style='color:#00BCD4;'>New Cross-Divisional Project Submission</h2>" &
                "<p><strong>Submitted by:</strong> " & gblUserName & " (" & gblUserEmail & ")</p>" &
                "<p><strong>Submission ID:</strong> " & gblCurrentSubmission.SubmissionId & "</p>" &
                "<p><strong>Submitted on:</strong> " & Text(Now(), DateTimeFormat.ShortDateTime) & "</p>" &
                "<hr/>" &
                "<h3>Summary</h3>" &
                "<ul>" &
                "<li><strong>Total Projects:</strong> " & gblSubmissionMetrics.TotalProjects & "</li>" &
                "<li><strong>Complete Projects:</strong> " & gblSubmissionMetrics.CompleteProjects & "</li>" &
                "<li><strong>Total Security Features:</strong> " & gblSubmissionMetrics.TotalFeatures & "</li>" &
                "<li><strong>Missing Specs:</strong> " & If(gblSubmissionMetrics.TotalMissing = 0, "None ✓", gblSubmissionMetrics.TotalMissing & " ⚠") & "</li>" &
                "</ul>" &
                "<hr/>" &
                "<h3>Project Details</h3>" &
                "<ol>" & varProjectSummaries & "</ol>" &
                "<hr/>" &
                "<p style='color:#666;font-size:12px;'>View full details in the <a href='https://make.powerapps.com'>Cross-Divisional Project Database</a></p>" &
                "</body></html>"
            );

            Set(varEmailBodyUser,
                "<html><body style='font-family:Segoe UI,Arial,sans-serif;'>" &
                "<h2 style='color:#00BCD4;'>Submission Confirmed</h2>" &
                "<p>Dear " & gblUserName & ",</p>" &
                "<p>Your submission has been successfully received and is now under review.</p>" &
                "<p><strong>Submission ID:</strong> " & gblCurrentSubmission.SubmissionId & "</p>" &
                "<p><strong>Total Projects:</strong> " & gblSubmissionMetrics.TotalProjects & "</p>" &
                "<p><strong>Security Features:</strong> " & gblSubmissionMetrics.TotalFeatures & "</p>" &
                "<p>You will be notified once your submission has been reviewed.</p>" &
                "<p style='color:#666;font-size:12px;'>Thank you for using the Cross-Divisional Project Database.</p>" &
                "</body></html>"
            );

            Office365Outlook.SendEmailV2(
                gblConfig.AdminEmail,
                "[Cross-Div DB] New Submission #" & gblCurrentSubmission.SubmissionId,
                varEmailBodyAdmin
            );
            Office365Outlook.SendEmailV2(
                gblUserEmail,
                "[Cross-Div DB] Submission Confirmed #" & gblCurrentSubmission.SubmissionId,
                varEmailBodyUser
            );
            Set(gblShowSubmitConfirm, false);
            Set(gblToastMessage, "Submission complete! Confirmation emails sent.");
            Set(gblToastType, "success");
            Set(gblShowToast, true);
            Navigate(scrHome, ScreenTransition.Fade)
