# Cross-Divisional Project Database - Power Apps Package

## ğŸ“¦ Package Overview

This package contains a **production-ready Microsoft Power Apps Canvas App** for managing cross-divisional project submissions with:

- âœ… **Multi-project intake** (1-5 projects per submission)
- âœ… **Security feature tracking** with specification requirements
- âœ… **Autosave & resume** functionality
- âœ… **Clone projects** (copies fields + security details)
- âœ… **Admin dashboard** for review and management
- âœ… **Modern dark theme** with neon accents (cyan/purple/pink)
- âœ… **Email notifications** on submission
- âœ… **Validation system** preventing incomplete submissions
- âœ… **SharePoint integration** for document storage
- âœ… **Support ticket system** for user assistance

**Version:** 2.1 (Final - Import-Ready)
**Last Updated:** 2025-12-22
**Platform:** Microsoft Power Apps + Dataverse
**License Required:** Power Apps Premium (Per User/App)

---

## ğŸš€ Quick Start (5-Minute Setup)

If you just want to get the app imported and running:

### Step 1: Generate the .msapp File

The package contains **source files** that need to be compiled first.

**On Windows:**
```cmd
cd CrossDivProjectDB_Package
RepackToolkit\repack.cmd
```

**On macOS/Linux (with PAC CLI installed):**
```bash
cd CrossDivProjectDB_Package
./RepackToolkit/repack.ps1
```

This creates `CanvasApp/CrossDivProjectDB.msapp` (ready to import).

### Step 2: Import into Power Apps

1. Go to **https://make.powerapps.com**
2. Select your **environment**
3. **Apps** â†’ **Import canvas app**
4. Upload `CanvasApp/CrossDivProjectDB.msapp`
5. Click **Import**

### Step 3: Complete Post-Import Setup

Follow the **`Docs/POST_IMPORT_CHECKLIST.md`** (45-60 minutes) to:
- Create Dataverse tables
- Import seed data
- Connect data sources
- Update placeholders (admin email, SharePoint URL)

---

## ğŸ“‚ Package Contents

```
CrossDivProjectDB_Package/
â”‚
â”œâ”€â”€ CanvasSource/               â† Power Apps source files (YAML/JSON)
â”‚   â”œâ”€â”€ Src/
â”‚   â”‚   â”œâ”€â”€ App.fx.yaml         (App configuration + theme)
â”‚   â”‚   â”œâ”€â”€ scrHome.fx.yaml     (Home screen)
â”‚   â”‚   â”œâ”€â”€ scrProjectList.fx.yaml  (Project management)
â”‚   â”‚   â”œâ”€â”€ scrWizardStep1-4.fx.yaml  (4-step wizard)
â”‚   â”‚   â”œâ”€â”€ scrMySubmissions.fx.yaml  (User submissions)
â”‚   â”‚   â”œâ”€â”€ scrAdminDashboard.fx.yaml  (Admin panel)
â”‚   â”‚   â”œâ”€â”€ scrSubmissionReview.fx.yaml  (Review before submit)
â”‚   â”‚   â”œâ”€â”€ scrTickets.fx.yaml  (Support tickets)
â”‚   â”‚   â””â”€â”€ scrTicketChat.fx.yaml  (Ticket messaging)
â”‚   â”œâ”€â”€ Header.json             (App metadata)
â”‚   â”œâ”€â”€ Properties.json         (App properties)
â”‚   â”œâ”€â”€ Connections/            (Data connections)
â”‚   â”œâ”€â”€ Entropy/                (Internal tracking)
â”‚   â””â”€â”€ pkgs/                   (Table definitions)
â”‚
â”œâ”€â”€ CanvasApp/                  â† Output folder for compiled .msapp
â”‚   â””â”€â”€ CrossDivProjectDB.msapp (Generated by repack script)
â”‚
â”œâ”€â”€ RepackToolkit/              â† Scripts to generate .msapp
â”‚   â”œâ”€â”€ repack.ps1              (PowerShell version)
â”‚   â”œâ”€â”€ repack.cmd              (Batch version)
â”‚   â””â”€â”€ README_REPACK.md        (Detailed repack instructions)
â”‚
â”œâ”€â”€ SeedData/                   â† CSV files for initial data
â”‚   â”œâ”€â”€ Seed_SecurityFeatures.csv  (22 security features)
â”‚   â”œâ”€â”€ Seed_AppConfig.csv         (5 app settings)
â”‚   â””â”€â”€ Seed_ChoiceValues.csv      (Reference for choice fields)
â”‚
â”œâ”€â”€ Docs/                       â† Complete documentation
â”‚   â”œâ”€â”€ POST_IMPORT_CHECKLIST.md   (Step-by-step setup guide)
â”‚   â”œâ”€â”€ DATAVERSE_SCHEMA.md        (Table schemas - 8 tables)
â”‚   â”œâ”€â”€ TABLE_NAME_MAPPING_GUIDE.md (How to find table names)
â”‚   â”œâ”€â”€ REPACK_PIPELINE.md         (Regenerate .msapp after changes)
â”‚   â””â”€â”€ THEME_DOCUMENTATION.md     (UI customization guide)
â”‚
â””â”€â”€ README.md                   â† This file
```

---

## ğŸ¯ Key Features

### 1. Multi-Project Submission System

- Users can create **1-5 projects per submission**
- Each project goes through a **4-step wizard**:
  - **Step 1:** Basic Info (name, customer, status)
  - **Step 2:** Additional details (contacts, blockers)
  - **Step 3:** Technology (microcontroller, architecture, protocols)
  - **Step 4:** Security features (select features + enter specs)

### 2. Intelligent Validation

- **Protocols:** Multi-select (CAN, LIN, Ethernet, etc.)
  â†’ If "Other" selected, must specify which protocols
- **Microcontroller:** Dropdown with "Other" option
  â†’ If "Other" selected, must specify which microcontroller
- **Security Features:** Each selected feature requires:
  - Spec Version (e.g., "v2.1")
  - Spec Details (implementation notes)
- **Submit blocked** until all projects are complete with no validation errors

### 3. Autosave & Resume

- **Timer-based autosave:** Every 90 seconds (configurable)
- **Save on navigation:** Saves when moving between screens
- **Resume feature:** Returns user to last edited screen/project
- **Toast notifications:** "Auto-saved" confirmation

### 4. Clone Projects

- **One-click clone** button on project cards
- **Copies all fields:** Name, customer, status, technology details, etc.
- **Copies security features:** Clones selected features + specs
- **Does NOT copy docs:** Document links remain unique per project
- **Respects 5-project limit:** Clone disabled at maximum

### 5. Admin Features

- **Admin Dashboard** screen (access controlled by email)
- **Review submissions** before approval
- **Email notifications** to admin on submit
- **Support ticket system** for user questions

### 6. Modern UI/UX

- **Dark theme** with near-black background (#0D1117)
- **Neon accents:**
  - Primary: Cyan (#00BCD4)
  - Secondary: Purple (#7C4DFF)
  - Accent: Pink (#FF4081)
- **Smooth animations** and transitions
- **Responsive layout** (optimized for desktop/tablet)
- **Consistent spacing** using design tokens

---

## ğŸ“‹ Prerequisites

### Required

- **Microsoft Power Apps** license (Premium: Per User or Per App)
- **Dataverse environment** with database
- **Maker permissions** to create apps and tables
- **Power Platform CLI** installed (for repacking)

### Optional

- **Office 365 Outlook** connection (for email notifications)
- **SharePoint** site (for document storage)
- **Power Automate** license (for advanced workflows)

---

## ğŸ› ï¸ Installation Guide

### Full Installation (First Time)

**Time Required:** 60-75 minutes

1. **Install Power Platform CLI**
   ```bash
   dotnet tool install --global Microsoft.PowerApps.CLI.Tool
   ```
   Or download: https://aka.ms/PowerAppsCLI

2. **Generate .msapp File**
   ```cmd
   cd CrossDivProjectDB_Package
   RepackToolkit\repack.cmd
   ```
   See `RepackToolkit/README_REPACK.md` for troubleshooting

3. **Import App**
   - Go to https://make.powerapps.com
   - Apps â†’ Import canvas app
   - Upload `CanvasApp/CrossDivProjectDB.msapp`

4. **Create Dataverse Tables** (20 min)
   - Follow `Docs/DATAVERSE_SCHEMA.md`
   - Create 8 tables with specified columns and relationships

5. **Import Seed Data** (5 min)
   - Import `SeedData/Seed_SecurityFeatures.csv` â†’ Security Features table
   - Import `SeedData/Seed_AppConfig.csv` â†’ App Configuration table

6. **Connect Data Sources** (10 min)
   - Open app in Power Apps Studio
   - Data panel â†’ Add all 8 tables
   - See `Docs/TABLE_NAME_MAPPING_GUIDE.md` for help

7. **Configure Placeholders** (5 min)
   - Edit App.fx.yaml â†’ OnStart
   - Update:
     - `AdminEmail: "your.admin@company.com"`
     - `SharePointFolderURL: "https://..."`

8. **Test & Verify** (15 min)
   - Create test submission
   - Test clone feature
   - Test autosave
   - Verify 5-project limit
   - Test validation

**Complete checklist:** `Docs/POST_IMPORT_CHECKLIST.md`

---

## ğŸ”§ Configuration

### Placeholders to Update

The app has **3 placeholders** you must configure:

| Placeholder | Location | Purpose | Required? |
|-------------|----------|---------|-----------|
| `<<CHANGE_ADMIN_EMAIL>>` | App.fx.yaml â†’ OnStart â†’ gblConfig.AdminEmail | Admin notification email | **Yes** |
| `<<CHANGE_ADMIN_CC>>` | App.fx.yaml â†’ OnStart â†’ gblConfig.AdminEmailCC | CC recipients (comma-separated) | No (can be empty) |
| `<<CHANGE_SHAREPOINT_FOLDER_URL>>` | App.fx.yaml â†’ OnStart â†’ gblConfig.SharePointFolderURL | Document storage URL | **Yes** |

**How to edit:**
1. Open app in Power Apps Studio
2. Select **App** object (top of tree view)
3. Find **OnStart** property in formula bar
4. Update the values in `Set(gblConfig, { ... })`
5. Save and preview

### Optional Settings

Modify in the same `gblConfig` section:

```javascript
Set(gblConfig, {
    AdminEmail: "your.admin@company.com",
    AdminEmailCC: "team@company.com",
    SharePointFolderURL: "https://yourcompany.sharepoint.com/...",

    // Optional: Change autosave interval (milliseconds)
    AutosaveInterval: 90000,  // Default: 90 seconds

    // Optional: Change max projects per submission
    MaxProjects: 5  // Default: 5 (do not increase without testing)
});
```

---

## ğŸ—„ï¸ Dataverse Schema

The app requires **8 Dataverse tables**:

| # | Table Name | Purpose | # Columns |
|---|------------|---------|-----------|
| 1 | **Submissions** | Parent submission records | 11 |
| 2 | **Projects** | Project details (1-5 per submission) | 25 |
| 3 | **Project Security Details** | Security features per project | 6 |
| 4 | **Project Documents** | Document links per project | 5 |
| 5 | **Security Features** | Master list of available features | 4 |
| 6 | **Support Tickets** | User-submitted support tickets | 7 |
| 7 | **Ticket Messages** | Chat messages in tickets | 5 |
| 8 | **App Configuration** | Global app settings | 4 |

**Complete schemas:** See `Docs/DATAVERSE_SCHEMA.md`

**Relationships:**
- Projects â†’ Submissions (many-to-one)
- Project Security Details â†’ Projects (many-to-one)
- Project Security Details â†’ Security Features (many-to-one)
- Project Documents â†’ Projects (many-to-one)
- Ticket Messages â†’ Support Tickets (many-to-one)

---

## ğŸ“Š Seed Data

### Security Features (22 records)

Pre-defined security features that users can select:

- Secure Boot
- Memory Protection (MPU/MMU)
- Trusted Execution Environment (TEE)
- Hardware Security Module (HSM)
- Code Signing & Verification
- Secure Debug Interface
- Runtime Integrity Checks
- Encrypted Communication (CAN, Ethernet)
- Authenticated Flash Updates
- Rollback Protection
- Secure Key Storage
- Random Number Generator (TRNG/PRNG)
- Intrusion Detection
- Supply Chain Security (SBOMs, Provenance)
- Fault Injection Resistance
- Side-Channel Attack Mitigation
- Secure OTA Updates
- Certificate Management (PKI)
- Access Control & Role-Based Security
- Data-at-Rest Encryption
- Secure Logging & Audit Trails
- Third-Party Security Audits & Pen Testing

**File:** `SeedData/Seed_SecurityFeatures.csv`

### App Configuration (5 records)

| Config Key | Default Value | Description |
|------------|---------------|-------------|
| MaxProjects | 5 | Maximum projects per submission |
| AutosaveInterval | 90000 | Autosave timer (milliseconds) |
| AdminNotificationEnabled | true | Send email on submission |
| RequireSecuritySpecs | true | Enforce spec entry for features |
| DefaultProjectStatus | Not Started | New project default status |

**File:** `SeedData/Seed_AppConfig.csv`

---

## ğŸ¨ Theme Customization

The app uses a **global theme variable** (`gblTheme`) defined in `App.fx.yaml`.

### Color Palette

```javascript
// Current theme colors
Primary: #00BCD4 (cyan)      â†’ CTAs, links, primary actions
Secondary: #7C4DFF (purple)  â†’ Accents, secondary elements
Accent: #FF4081 (pink)       â†’ Highlights, important badges
Success: #00E676 (green)     â†’ Success states
Warning: #FFC107 (amber)     â†’ Warnings
Error: #FF5252 (red)         â†’ Errors, required field indicators

Background: #0D1117 (near-black)
BackgroundSecondary: #161B22 (elevated)
BackgroundCard: #1E252E (cards/containers)
```

**How to customize:**
1. Open `CanvasSource/Src/App.fx.yaml`
2. Find `Set(gblTheme, { ... })`
3. Update RGBA values
4. Run `repack.cmd` to regenerate .msapp
5. Re-import into Power Apps

**Full guide:** `Docs/THEME_DOCUMENTATION.md`

---

## ğŸ“– Documentation Index

| Document | Purpose | When to Use |
|----------|---------|-------------|
| **README.md** | Package overview (this file) | Start here |
| **RepackToolkit/README_REPACK.md** | Generate .msapp from source | Before first import, after any source changes |
| **Docs/POST_IMPORT_CHECKLIST.md** | Complete setup guide | After importing .msapp |
| **Docs/DATAVERSE_SCHEMA.md** | Table/column definitions | When creating Dataverse tables |
| **Docs/TABLE_NAME_MAPPING_GUIDE.md** | Find and map table names | If tables don't connect properly |
| **Docs/REPACK_PIPELINE.md** | Modify and repack workflow | When editing source files |
| **Docs/THEME_DOCUMENTATION.md** | Customize colors/styling | When changing app appearance |

---

## â“ FAQ

### Q: Why do I need to "repack" the app?

**A:** Power Apps import requires a compiled `.msapp` binary file, not raw YAML source files. The `repack` script uses Power Platform CLI to compile the source into an `.msapp`.

### Q: Can I edit the .msapp directly?

**A:** You can import and edit in Power Apps Studio, but changes won't be reflected in this package. For version control, edit the CanvasSource files and repack.

### Q: What if I don't have the Power Platform CLI?

**A:** Install it first:
```bash
dotnet tool install --global Microsoft.PowerApps.CLI.Tool
```
Or download: https://aka.ms/PowerAppsCLI

See `RepackToolkit/README_REPACK.md` for detailed installation instructions.

### Q: The import says "Error opening file"

**A:** The `.msapp` file is either missing, corrupted, or 0 bytes. Run `repack.cmd` to generate it properly. See `RepackToolkit/README_REPACK.md` troubleshooting section.

### Q: My table names are different (e.g., `new_projects` instead of `cr_projects`)

**A:** That's expected! Dataverse uses your publisher prefix. Use **Display Names** when connecting tables in Power Apps Studio. See `Docs/TABLE_NAME_MAPPING_GUIDE.md`.

### Q: How do I find the logical names of my tables?

**A:** Go to make.powerapps.com â†’ Tables â†’ Click table â†’ Properties panel (right side) shows the logical name. Full guide: `Docs/TABLE_NAME_MAPPING_GUIDE.md`

### Q: Can I change the 5-project limit?

**A:** Yes, edit `MaxProjects` in `gblConfig` (App.fx.yaml â†’ OnStart). However, test thoroughly as UI layout is optimized for 5 projects.

### Q: How do I add more security features?

**A:** Add records to the **Security Features** Dataverse table. Users will see them in Step 4 of the wizard automatically.

### Q: Email notifications aren't working

**A:** Check:
1. Office 365 Outlook connector is added (Data panel)
2. `AdminEmail` placeholder is updated with valid email
3. User has permissions to send email via Office 365

See `Docs/POST_IMPORT_CHECKLIST.md` â†’ Phase 5.

### Q: Can I use this without SharePoint?

**A:** Yes. The SharePoint integration is optional. Update the `SharePointFolderURL` placeholder to any URL or leave it as-is (users can still manually add document links).

### Q: How do I upgrade to a newer version of this package?

**A:**
1. Export your current app from Power Apps (Apps â†’ Export)
2. Back up your Dataverse data
3. Import the new `.msapp`
4. Reconnect data sources
5. Re-apply placeholder configurations

---

## ğŸ› Troubleshooting

### Issue: Repack fails with "pac is not recognized"

**Solution:** Install Power Platform CLI:
```bash
dotnet tool install --global Microsoft.PowerApps.CLI.Tool
```
Then restart your terminal.

### Issue: .msapp file is 0 KB

**Solution:** The repack failed. Check the PAC CLI output for errors. Common causes:
- Corrupted YAML files
- Missing required files (App.fx.yaml, Header.json)
- Invalid YAML syntax

### Issue: Tables don't appear in Add Data panel

**Solution:**
1. Ensure tables are created in the same environment
2. Check table ownership (should be User/Team owned, not Organization)
3. Refresh data sources: Data panel â†’ â‹® â†’ Refresh all

Full guide: `Docs/TABLE_NAME_MAPPING_GUIDE.md` â†’ "If Tables Don't Appear"

### Issue: Dropdowns are empty (Customer, Microcontroller, etc.)

**Solution:** Add choice values to table columns. See `Docs/DATAVERSE_SCHEMA.md` for the exact values to add for each column.

### Issue: "You do not have permission" errors

**Solution:**
1. Check Dataverse table permissions
2. Add your user with Read/Write access
3. Verify your security role has table privileges

### Issue: Autosave not working

**Solution:**
1. Check that `gblConfig.AutosaveInterval` is set (default: 90000)
2. Verify timer is running: Check for toast notification after 90 seconds
3. Test manually: Edit a project, wait, exit app, reopen, verify draft saved

---

## ğŸš¦ Quality Checklist

Before deploying to production, verify:

### âœ… Repack & Import
- [ ] Repack script runs without errors
- [ ] .msapp file size > 0 KB (should be ~150-200 KB)
- [ ] App imports into Power Apps successfully

### âœ… Dataverse
- [ ] All 8 tables created
- [ ] All columns created with correct data types
- [ ] Choice values added to dropdown columns
- [ ] Lookup relationships configured
- [ ] Seed data imported (Security Features, App Configuration)

### âœ… App Configuration
- [ ] All 8 data sources connected
- [ ] No errors in App Checker panel
- [ ] Placeholders updated (admin email, SharePoint URL)
- [ ] Email connector added (Office 365 Outlook)

### âœ… Feature Testing
- [ ] Can create submission and add projects (1-5)
- [ ] 5-project limit enforced (button disabled at max)
- [ ] Clone project works (fields + security features copied)
- [ ] Autosave works (90-second timer, toast notification)
- [ ] Resume works (returns to last screen/project)
- [ ] Protocols multi-select works (CAN, LIN, Ethernet, Other)
- [ ] "Other" fields required when selected
- [ ] Security features require SpecVersion + SpecDetails
- [ ] Validation blocks submit when incomplete
- [ ] Submit sends email to admin
- [ ] SharePoint button opens correct URL

### âœ… Permissions
- [ ] App shared with users
- [ ] Users have Dataverse table permissions
- [ ] Admin users identified and configured

---

## ğŸ“ Support

### Getting Help

1. **Check the documentation:**
   - Start with `Docs/POST_IMPORT_CHECKLIST.md`
   - Review `Docs/TABLE_NAME_MAPPING_GUIDE.md` for connection issues
   - See `RepackToolkit/README_REPACK.md` for repack problems

2. **Microsoft Resources:**
   - Power Apps Docs: https://learn.microsoft.com/power-apps/
   - Dataverse Docs: https://learn.microsoft.com/power-apps/maker/data-platform/
   - Power Apps Community: https://powerusers.microsoft.com/t5/Power-Apps-Community/ct-p/PowerApps1

3. **Power Platform CLI:**
   - CLI Docs: https://learn.microsoft.com/power-platform/developer/cli/introduction
   - Download: https://aka.ms/PowerAppsCLI

---

## ğŸ“ Version History

### Version 2.1 (2025-12-21) - Current

**Enhancements:**
- âœ… Fixed packaging for import (proper .msapp generation)
- âœ… Enhanced repack scripts (PowerShell + Batch with validation)
- âœ… Comprehensive documentation (5 guides + README)
- âœ… Table name mapping guide for Dataverse environments
- âœ… Post-import checklist with 60-minute setup guide
- âœ… Verified all required features implemented

**Features:**
- âœ… 5-project limit per submission
- âœ… Clone project (fields + security details)
- âœ… Autosave timer (90 seconds) + save on navigation
- âœ… Resume to last screen/project
- âœ… Admin email notifications
- âœ… Protocols multi-select with "Other" validation
- âœ… Microcontroller dropdown with "Other" validation
- âœ… Security features with required specs
- âœ… SharePoint integration button
- âœ… Validation system blocking incomplete submissions
- âœ… Modern dark theme with neon accents

---

## ğŸ“„ License

This Power Apps package is provided as-is for use within your organization's Microsoft Power Platform environment.

**Third-Party Components:**
- Microsoft Power Apps (requires license)
- Microsoft Dataverse (included with Power Apps license)
- Power Platform CLI (free, open-source)

---

## ğŸ“ Learning Resources

### For Power Apps Beginners

- **Microsoft Learn - Power Apps Fundamentals:** https://learn.microsoft.com/training/paths/create-powerapps/
- **Power Apps Canvas Apps in a Day:** https://learn.microsoft.com/power-apps/guidance/canvas-apps-in-a-day/

### For Dataverse

- **Dataverse for Beginners:** https://learn.microsoft.com/training/modules/get-started-with-powerapps-common-data-service/
- **Create tables in Dataverse:** https://learn.microsoft.com/power-apps/maker/data-platform/data-platform-create-entity

### For Power Platform CLI

- **CLI Introduction:** https://learn.microsoft.com/power-platform/developer/cli/introduction
- **Canvas app commands:** https://learn.microsoft.com/power-platform/developer/cli/reference/canvas

---

**Package Maintainer:** Claude AI
**Created:** 2025-12-21
**Package Version:** 2.1
**App Version:** 2.1
**Tested With:** Power Apps (December 2025), Power Platform CLI 1.x

---

**Ready to get started?** â†’ Run `RepackToolkit\repack.cmd` to generate your `.msapp` file!
